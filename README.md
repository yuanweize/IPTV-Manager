<div align="center">

# ğŸ¬ IPTV Manager

*é«˜æ€§èƒ½IPTVç›´æ’­æºç®¡ç†å·¥å…·*

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Python](https://img.shields.io/badge/python-3.6+-green.svg)](https://python.org)
[![Platform](https://img.shields.io/badge/platform-Linux-lightgrey.svg)](https://www.linux.org/)
[![GitHub stars](https://img.shields.io/github/stars/yuanweize/IPTV-Manager.svg?style=social)](https://github.com/yuanweize/IPTV-Manager/stargazers)

[English](README_EN.md) | ç®€ä½“ä¸­æ–‡

</div>

---

## ğŸ“– é¡¹ç›®ç®€ä»‹

ä¸€ä¸ªä¸“ä¸ºDebian/UbuntuæœåŠ¡å™¨ç¯å¢ƒè®¾è®¡çš„é«˜æ€§èƒ½IPTVç›´æ’­æºè‡ªåŠ¨ä¸‹è½½å’Œç®¡ç†è„šæœ¬ï¼Œæ”¯æŒå¤šæºå¹¶å‘ä¸‹è½½ã€è‡ªåŠ¨æ›´æ–°ã€é…ç½®åŒ–ç®¡ç†å’Œå®Œæ•´çš„ç»´æŠ¤åŠŸèƒ½ã€‚

ğŸ“š **ç›¸å…³æ–‡æ¡£**ï¼š
- [æ›´æ–°æ—¥å¿—](CHANGELOG.md) - æŸ¥çœ‹é¡¹ç›®çš„ç‰ˆæœ¬å†å²å’Œå˜æ›´è®°å½•ã€‚
- [è´¡çŒ®æŒ‡å—](CONTRIBUTING.md) - äº†è§£å¦‚ä½•ä¸ºé¡¹ç›®è´¡çŒ®ä»£ç æˆ–æŠ¥å‘Šé—®é¢˜ã€‚
- [é¡¹ç›®ç»“æ„](PROJECT_STRUCTURE.md) - äº†è§£é¡¹ç›®çš„ç›®å½•ç»“æ„å’Œè®¾è®¡ç†å¿µã€‚

## ğŸš€ ä¸€é”®å®‰è£…

### æ–¹æ³•1: äº¤äº’å¼å®‰è£…ï¼ˆæ¨èï¼‰

ä¸‹è½½å®‰è£…è„šæœ¬åè¿è¡Œï¼Œå¯ä»¥è‡ªå®šä¹‰æ‰€æœ‰é…ç½®é€‰é¡¹ï¼š

```bash
wget -O install.sh https://raw.githubusercontent.com/yuanweize/IPTV-Manager/refs/heads/main/install.sh
chmod +x install.sh
./install.sh
```

### æ–¹æ³•2: å¿«é€Ÿå®‰è£…

ä½¿ç”¨é»˜è®¤é…ç½®ä¸€é”®å®‰è£…ï¼š

```bash
curl -fsSL https://raw.githubusercontent.com/yuanweize/IPTV-Manager/refs/heads/main/install.sh | bash
```

### æ–¹æ³•3: è‡ªå®šä¹‰å®‰è£…

ä½¿ç”¨ç¯å¢ƒå˜é‡æŒ‡å®šè‡ªå®šä¹‰é…ç½®ï¼š

```bash
# è‡ªå®šä¹‰å®‰è£…ç›®å½•å’Œæ•°æ®ç›®å½•
CUSTOM_INSTALL_DIR=/home/user/iptv CUSTOM_DATA_DIR=/media/iptv bash install.sh

# å®Œå…¨éäº¤äº’å¼å®‰è£…
SKIP_INTERACTIVE=true CUSTOM_INSTALL_DIR=/opt/iptv bash install.sh
```

### ğŸ“ å®‰è£…é€‰é¡¹è¯¦è§£

#### äº¤äº’å¼å®‰è£…é€‰é¡¹

å®‰è£…è¿‡ç¨‹ä¸­ä¼šä¾æ¬¡è¯¢é—®ä»¥ä¸‹é…ç½®ï¼Œæ¯ä¸ªé€‰é¡¹éƒ½æœ‰æ¸…æ™°çš„æç¤ºï¼š

1. **Rootç”¨æˆ·æ£€æŸ¥**ï¼š
   ```
   [WARN] æ£€æµ‹åˆ°rootç”¨æˆ·ï¼Œå»ºè®®ä½¿ç”¨æ™®é€šç”¨æˆ·è¿è¡Œæ­¤è„šæœ¬
   æ˜¯å¦ç»§ç»­? (y/N):
   ```

2. **å®‰è£…è·¯å¾„é€‰æ‹©**ï¼š
   ```
   è¯·é€‰æ‹©å®‰è£…è·¯å¾„:
   1) ä½¿ç”¨é»˜è®¤è·¯å¾„: /opt/IPTV-Manager
   2) è‡ªå®šä¹‰è·¯å¾„
   è¾“å…¥é€‰é¡¹å›è½¦é»˜è®¤: 1 >
   ```

3. **æ•°æ®ç›®å½•é€‰æ‹©**ï¼š
   ```
   è¯·é€‰æ‹©ç›´æ’­æºæ–‡ä»¶ä¿å­˜ç›®å½•:
   1) ä½¿ç”¨é»˜è®¤ç›®å½•: /opt/IPTV-Manager/data
   2) è‡ªå®šä¹‰ç›®å½• (æ¨èç”¨äºå¤§å®¹é‡å­˜å‚¨)
   è¾“å…¥é€‰é¡¹å›è½¦é»˜è®¤: 1 >
   ```

4. **å®‰è£…åæ“ä½œ**ï¼š
   ```
   å®‰è£…å®Œæˆåç«‹å³è¿è¡Œ(Y/n):
   Y) ç«‹å³ä¸‹è½½ç›´æ’­æº (æ¨èï¼ŒéªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸ)
   n) ä»…å®Œæˆå®‰è£…ï¼Œç¨åæ‰‹åŠ¨è¿è¡Œ
   è¾“å…¥é€‰é¡¹å›è½¦é»˜è®¤: Y >
   ```

5. **å…¨å±€å‘½ä»¤è½¯è¿æ¥**ï¼š
   ```
   æ˜¯å¦åˆ›å»ºå…¨å±€å‘½ä»¤è½¯è¿æ¥?(Y/n):
   ```

6. **å®šæ—¶ä»»åŠ¡è®¾ç½®**ï¼š
   ```
   è¯·é€‰æ‹©å®šæ—¶ä»»åŠ¡é¢‘ç‡:
   1) æ¯6å°æ—¶æ‰§è¡Œä¸€æ¬¡ (æ¨è)
   2) æ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œ
   3) æ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡
   4) è·³è¿‡å®šæ—¶ä»»åŠ¡è®¾ç½®
   è¾“å…¥é€‰æ‹©å›è½¦é»˜è®¤: 1 >
   ```

7. **é…ç½®ç¡®è®¤**ï¼š
   ```
   ç¡®è®¤ä»¥ä¸Šé…ç½®å¹¶å¼€å§‹å®‰è£…? (Y/n):
   ```

#### ç¯å¢ƒå˜é‡é…ç½®

æ”¯æŒä»¥ä¸‹ç¯å¢ƒå˜é‡è¿›è¡Œéäº¤äº’å¼é…ç½®ï¼š

| ç¯å¢ƒå˜é‡             | è¯´æ˜               | é»˜è®¤å€¼              |
| -------------------- | ------------------ | ------------------- |
| `SKIP_INTERACTIVE`   | è·³è¿‡äº¤äº’æ¨¡å¼       | `false`             |
| `INSTALL_LANGUAGE`   | ç•Œé¢è¯­è¨€           | `zh` (ä¸­æ–‡)         |
| `CUSTOM_INSTALL_DIR` | è‡ªå®šä¹‰å®‰è£…ç›®å½•     | `/opt/IPTV-Manager` |
| `CUSTOM_DATA_DIR`    | è‡ªå®šä¹‰æ•°æ®ç›®å½•     | `{å®‰è£…ç›®å½•}/data`   |
| `AUTO_RUN`           | å®‰è£…åè‡ªåŠ¨è¿è¡Œ     | `Y`                 |
| `CREATE_SYMLINK`     | åˆ›å»ºå…¨å±€å‘½ä»¤è½¯è¿æ¥ | `Y`                 |

#### ä½¿ç”¨ç¤ºä¾‹

```bash
# æŸ¥çœ‹å®‰è£…å¸®åŠ©
bash install.sh --help

# å®‰è£…åˆ°ç”¨æˆ·ç›®å½•ï¼Œæ•°æ®ä¿å­˜åˆ°å¤–éƒ¨ç£ç›˜
CUSTOM_INSTALL_DIR=$HOME/iptv-manager \
CUSTOM_DATA_DIR=/mnt/storage/iptv \
bash install.sh

# æœåŠ¡å™¨è‡ªåŠ¨åŒ–éƒ¨ç½²
SKIP_INTERACTIVE=true \
CUSTOM_INSTALL_DIR=/opt/iptv \
AUTO_RUN=n \
CREATE_SYMLINK=n \
bash install.sh

# åˆ›å»ºè½¯è¿æ¥ä½†ä¸è‡ªåŠ¨è¿è¡Œ
CUSTOM_INSTALL_DIR=/home/user/iptv \
AUTO_RUN=n \
bash install.sh
```

### ğŸ¯ å®‰è£…åçš„ç›®å½•ç»“æ„

```
{å®‰è£…ç›®å½•}/
â”œâ”€â”€ iptv_manager.py          # ä¸»è„šæœ¬æ–‡ä»¶
â”œâ”€â”€ config.json              # é…ç½®æ–‡ä»¶
â”œâ”€â”€ backup/                  # å¤‡ä»½ç›®å½•
â”œâ”€â”€ logs/                    # æ—¥å¿—ç›®å½•
â””â”€â”€ requirements.txt         # Pythonä¾èµ–

{æ•°æ®ç›®å½•}/                   # ç›´æ’­æºæ–‡ä»¶ç›®å½•ï¼ˆå¯ç‹¬ç«‹é…ç½®ï¼‰
â”œâ”€â”€ domestic.m3u             # å›½å†…æºæ–‡ä»¶
â””â”€â”€ international.m3u        # å›½é™…æºæ–‡ä»¶
```

> ğŸ’¡ **ç›®å½•è¯´æ˜**ï¼š
> - å®‰è£…ç›®å½•åŒ…å«ç¨‹åºæ–‡ä»¶ã€é…ç½®å’Œæ—¥å¿—
> - æ•°æ®ç›®å½•å¯ä»¥ç‹¬ç«‹é…ç½®ï¼Œä¾¿äºä½¿ç”¨å¤§å®¹é‡å­˜å‚¨
> - `/opt` ç›®å½•æ˜¯Linuxç³»ç»Ÿå­˜æ”¾ç¬¬ä¸‰æ–¹è½¯ä»¶çš„æ ‡å‡†ä½ç½®

## åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- ğŸš€ **å¤šæºå¹¶å‘ä¸‹è½½**: æ”¯æŒåŒæ—¶ä¸‹è½½å¤šä¸ªIPTVç›´æ’­æºï¼Œæé«˜æ•ˆç‡
- âš™ï¸ **é…ç½®åŒ–ç®¡ç†**: æ‰€æœ‰å‚æ•°é€šè¿‡JSONé…ç½®æ–‡ä»¶ç®¡ç†ï¼Œæ˜“äºç»´æŠ¤
- ğŸ”„ **è‡ªåŠ¨é‡è¯•æœºåˆ¶**: ç½‘ç»œå¤±è´¥æ—¶è‡ªåŠ¨é‡è¯•ï¼Œç¡®ä¿ä¸‹è½½æˆåŠŸç‡
- ğŸ“ **å®Œæ•´æ—¥å¿—è®°å½•**: è¯¦ç»†çš„è¿è¡Œæ—¥å¿—ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥
- ğŸ—‚ï¸ **æ–‡ä»¶ç‰ˆæœ¬æ§åˆ¶**: è‡ªåŠ¨å¤‡ä»½å†å²ç‰ˆæœ¬ï¼Œæ”¯æŒå›æ»š
- ğŸ§¹ **è‡ªåŠ¨æ¸…ç†ç»´æŠ¤**: å®šæœŸæ¸…ç†è¿‡æœŸæ–‡ä»¶ï¼Œä¿æŒç³»ç»Ÿæ•´æ´

### é«˜çº§ç‰¹æ€§
- ğŸŒ **ç¼–ç è‡ªåŠ¨æ£€æµ‹**: æ™ºèƒ½æ£€æµ‹M3Uæ–‡ä»¶ç¼–ç ï¼Œç¡®ä¿å…¼å®¹æ€§
- ğŸ”’ **æƒé™ç®¡ç†**: è‡ªåŠ¨è®¾ç½®æ­£ç¡®çš„æ–‡ä»¶å’Œç›®å½•æƒé™
- ğŸ“Š **çŠ¶æ€æŠ¥å‘Š**: ç”Ÿæˆè¯¦ç»†çš„æ‰§è¡ŒçŠ¶æ€æŠ¥å‘Š
- â° **å®šæ—¶ä»»åŠ¡å…¼å®¹**: å®Œç¾æ”¯æŒcrontabå®šæ—¶æ‰§è¡Œ
- ğŸ›¡ï¸ **å¼‚å¸¸å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§

## ç³»ç»Ÿè¦æ±‚

- **æ“ä½œç³»ç»Ÿ**: Debian/Ubuntu Linux
- **Pythonç‰ˆæœ¬**: Python 3.6+
- **ä¾èµ–åº“**: requests, chardet

## å¿«é€Ÿå®‰è£…

### æ–¹æ³•1: è‡ªåŠ¨å®‰è£…ï¼ˆæ¨èï¼‰

```bash
# å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®æ–‡ä»¶åï¼Œè¿è¡Œå®‰è£…è„šæœ¬
chmod +x install.sh
./install.sh
```

### æ–¹æ³•2: æ‰‹åŠ¨å®‰è£…

```bash
# 1. ä¸‹è½½å®‰è£…è„šæœ¬
wget -O install.sh https://raw.githubusercontent.com/yuanweize/IPTV-Manager/refs/heads/main/install.sh
chmod +x install.sh

# 2. è¿è¡Œå®‰è£…è„šæœ¬ï¼ˆæ”¯æŒäº¤äº’å¼é…ç½®ï¼‰
./install.sh

# 3. æˆ–è€…ç›´æ¥å…‹éš†æ•´ä¸ªé¡¹ç›®
git clone https://github.com/yuanweize/IPTV-Manager.git
cd IPTV-Manager
./install.sh
```

### 3. é…ç½®æ–‡ä»¶è¯´æ˜

é…ç½®æ–‡ä»¶ `config.json` åŒ…å«ä»¥ä¸‹ä¸»è¦éƒ¨åˆ†ï¼š

#### ç›´æ’­æºé…ç½® (sources)
```json
{
  "sources": {
    "domestic": {
      "name": "å›½å†…æº",
      "url": "https://live.hacks.tools/tv/iptv4.m3u",
      "filename": "domestic.m3u",
      "enabled": true
    }
  }
}
```

- `name`: æºçš„æ˜¾ç¤ºåç§°
- `url`: M3Uæ–‡ä»¶çš„ä¸‹è½½åœ°å€
- `filename`: ä¿å­˜çš„æ–‡ä»¶å
- `enabled`: æ˜¯å¦å¯ç”¨æ­¤æº

#### ç›®å½•é…ç½® (directories)
```json
{
  "directories": {
    "base_dir": "/opt/IPTV-Manager",
    "data_dir": "/opt/IPTV-Manager/data",
    "backup_dir": "/opt/IPTV-Manager/backup", 
    "log_dir": "/opt/IPTV-Manager/logs"
  }
}
```

- `base_dir`: ç¨‹åºå®‰è£…çš„åŸºç¡€ç›®å½•
- `data_dir`: ç›´æ’­æºæ–‡ä»¶ä¿å­˜ç›®å½•ï¼ˆå¯ä»¥æ˜¯ç‹¬ç«‹è·¯å¾„ï¼‰
- `backup_dir`: å¤‡ä»½æ–‡ä»¶ä¿å­˜ç›®å½•
- `log_dir`: æ—¥å¿—æ–‡ä»¶ä¿å­˜ç›®å½•

#### ä¸‹è½½é…ç½® (download)
```json
{
  "download": {
    "timeout": 30,
    "retry_count": 3,
    "retry_delay": 5,
    "max_workers": 4,
    "user_agent": "IPTV-Manager/1.0"
  }
}
```

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ä½¿ç”¨

#### æ–¹æ³•1: ä½¿ç”¨å…¨å±€å‘½ä»¤ï¼ˆæ¨èï¼‰

å¦‚æœå®‰è£…æ—¶åˆ›å»ºäº†è½¯è¿æ¥ï¼Œå¯ä»¥åœ¨ä»»ä½•ä½ç½®ç›´æ¥ä½¿ç”¨ï¼š

```bash
# è¿›å…¥äº¤äº’å¼èœå•ï¼ˆæ¨èï¼‰
iptv

# ç›´æ¥ä¸‹è½½ç›´æ’­æºï¼ˆç”¨äºè„šæœ¬å’Œå®šæ—¶ä»»åŠ¡ï¼‰
iptv --download

# æŸ¥çœ‹çŠ¶æ€
iptv --status

# æŸ¥çœ‹å¸®åŠ©
iptv --help
```

#### æ–¹æ³•2: ä½¿ç”¨å®Œæ•´è·¯å¾„

```bash
# è¿›å…¥å®‰è£…ç›®å½•ï¼ˆé»˜è®¤ä¸º /opt/IPTV-Managerï¼‰
cd /opt/IPTV-Manager

# è¿›å…¥äº¤äº’å¼èœå•
python3 iptv_manager.py

# ç›´æ¥ä¸‹è½½ç›´æ’­æº
python3 iptv_manager.py --download

# æŸ¥çœ‹çŠ¶æ€
python3 iptv_manager.py --status

# æŸ¥çœ‹å¸®åŠ©
python3 iptv_manager.py --help
```

### äº¤äº’å¼èœå•

ç›´æ¥è¿è¡Œ `iptv` å‘½ä»¤ä¼šè¿›å…¥å‹å¥½çš„äº¤äº’å¼èœå•ï¼š

```
============================================================
    IPTVç›´æ’­æºç®¡ç†ç³»ç»Ÿ
============================================================
è¯·é€‰æ‹©è¦æ‰§è¡Œçš„æ“ä½œ:

1. [ä¸‹è½½] ä¸‹è½½/æ›´æ–°ç›´æ’­æº
2. [çŠ¶æ€] æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€
3. [åˆ—è¡¨] æŸ¥çœ‹ç›´æ’­æºåˆ—è¡¨
4. [é…ç½®] é…ç½®ç®¡ç†
5. [æ—¥å¿—] æŸ¥çœ‹æ—¥å¿—
6. [æ¸…ç†] æ¸…ç†ç»´æŠ¤
7. [æ›´æ–°] æ›´æ–°ç¨‹åº
8. [å¸è½½] å¸è½½ç¨‹åº
0. [é€€å‡º] é€€å‡ºç¨‹åº

============================================================
è¯·è¾“å…¥é€‰é¡¹ (0-8):
```

èœå•åŠŸèƒ½è¯´æ˜ï¼š
- **ä¸‹è½½/æ›´æ–°ç›´æ’­æº**: æ‰§è¡Œä¸»è¦çš„ä¸‹è½½ä»»åŠ¡
- **æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€**: æ˜¾ç¤ºè¯¦ç»†çš„ç³»ç»ŸçŠ¶æ€ä¿¡æ¯
- **æŸ¥çœ‹ç›´æ’­æºåˆ—è¡¨**: åˆ—å‡ºæ‰€æœ‰å·²ä¸‹è½½çš„ç›´æ’­æºæ–‡ä»¶
- **é…ç½®ç®¡ç†**: æŸ¥çœ‹å½“å‰é…ç½®ä¿¡æ¯
- **æŸ¥çœ‹æ—¥å¿—**: æ˜¾ç¤ºæœ€è¿‘çš„è¿è¡Œæ—¥å¿—
- **æ¸…ç†ç»´æŠ¤**: æ¸…ç†è¿‡æœŸçš„å¤‡ä»½å’Œæ—¥å¿—æ–‡ä»¶
- **æ›´æ–°ç¨‹åº**: æ£€æŸ¥å¹¶æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬
- **å¸è½½ç¨‹åº**: å®Œå…¨å¸è½½IPTVç®¡ç†ç³»ç»Ÿ

### é«˜çº§ç”¨æ³•

```bash
# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®æ–‡ä»¶
iptv --config /path/to/config.json
# æˆ–
python3 iptv_manager.py --config /path/to/config.json

# æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯
iptv --version
# æˆ–
python3 iptv_manager.py --version

# ç›´æ¥ä¸‹è½½æ¨¡å¼ï¼ˆè·³è¿‡èœå•ï¼Œç”¨äºè„šæœ¬ï¼‰
iptv --download
# æˆ–
python3 iptv_manager.py --download
```

### å®šæ—¶ä»»åŠ¡è®¾ç½®

ä½¿ç”¨crontabè®¾ç½®å®šæ—¶æ‰§è¡Œï¼š

```bash
# ç¼–è¾‘crontab
crontab -e

# ä½¿ç”¨å…¨å±€å‘½ä»¤ï¼ˆæ¨èï¼‰
0 */6 * * * iptv --download >> /opt/IPTV-Manager/logs/cron.log 2>&1

# æˆ–ä½¿ç”¨å®Œæ•´è·¯å¾„
0 */6 * * * cd /opt/IPTV-Manager && python3 iptv_manager.py --download >> /opt/IPTV-Manager/logs/cron.log 2>&1

# å…¶ä»–æ—¶é—´è®¾ç½®ç¤ºä¾‹
0 2 * * * iptv --download         # æ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œ
0 * * * * iptv --download         # æ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡
```

## ç›®å½•ç»“æ„

### é»˜è®¤ç›®å½•ç»“æ„

```
/opt/IPTV-Manager/           # å®‰è£…ç›®å½•
â”œâ”€â”€ iptv_manager.py          # ä¸»è„šæœ¬æ–‡ä»¶
â”œâ”€â”€ config.json              # é…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt         # Pythonä¾èµ–æ–‡ä»¶
â”œâ”€â”€ data/                    # ç›´æ’­æºæ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ domestic.m3u         # å›½å†…æºæ–‡ä»¶
â”‚   â””â”€â”€ international.m3u    # å›½é™…æºæ–‡ä»¶
â”œâ”€â”€ backup/                  # å¤‡ä»½ç›®å½•
â”‚   â”œâ”€â”€ domestic_20240102_143022.m3u
â”‚   â””â”€â”€ international_20240102_143022.m3u
â””â”€â”€ logs/                    # æ—¥å¿—ç›®å½•
    â”œâ”€â”€ iptv_manager_20240102.log
    â””â”€â”€ status_report_20240102_143022.txt
```

### è‡ªå®šä¹‰æ•°æ®ç›®å½•ç»“æ„

å¦‚æœä½ åœ¨å®‰è£…æ—¶é€‰æ‹©äº†è‡ªå®šä¹‰æ•°æ®ç›®å½•ï¼ˆå¦‚ `/media/iptv`ï¼‰ï¼Œç»“æ„å¦‚ä¸‹ï¼š

```
/opt/IPTV-Manager/           # å®‰è£…ç›®å½•
â”œâ”€â”€ iptv_manager.py          # ä¸»è„šæœ¬æ–‡ä»¶
â”œâ”€â”€ config.json              # é…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt         # Pythonä¾èµ–æ–‡ä»¶
â”œâ”€â”€ backup/                  # å¤‡ä»½ç›®å½•
â””â”€â”€ logs/                    # æ—¥å¿—ç›®å½•

/media/iptv/                 # è‡ªå®šä¹‰æ•°æ®ç›®å½•
â”œâ”€â”€ domestic.m3u             # å›½å†…æºæ–‡ä»¶
â””â”€â”€ international.m3u        # å›½é™…æºæ–‡ä»¶
```

> ğŸ’¡ **ç›®å½•ä¼˜åŠ¿**ï¼š
> - ç¨‹åºæ–‡ä»¶ä¸æ•°æ®æ–‡ä»¶åˆ†ç¦»ï¼Œä¾¿äºç®¡ç†
> - æ•°æ®ç›®å½•å¯é€‰æ‹©å¤§å®¹é‡å­˜å‚¨è®¾å¤‡
> - å¤‡ä»½å’Œæ—¥å¿—ä»ä¿å­˜åœ¨ç¨‹åºç›®å½•ï¼Œä¾¿äºç»´æŠ¤

## è½¯è¿æ¥ç®¡ç†

### åˆ›å»ºè½¯è¿æ¥

å¦‚æœå®‰è£…æ—¶æ²¡æœ‰åˆ›å»ºè½¯è¿æ¥ï¼Œå¯ä»¥æ‰‹åŠ¨åˆ›å»ºï¼š

```bash
# åˆ›å»ºè½¯è¿æ¥ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
sudo ln -sf /opt/IPTV-Manager/iptv_manager.py /usr/local/bin/iptv

# æˆ–åˆ›å»ºåŒ…è£…è„šæœ¬ï¼ˆæ¨èï¼‰
sudo tee /usr/local/bin/iptv > /dev/null << 'EOF'
#!/bin/bash
cd /opt/IPTV-Manager && python3 iptv_manager.py "$@"
EOF
sudo chmod +x /usr/local/bin/iptv
```

### åˆ é™¤è½¯è¿æ¥

```bash
# åˆ é™¤è½¯è¿æ¥
sudo rm -f /usr/local/bin/iptv
```

### éªŒè¯è½¯è¿æ¥

```bash
# æ£€æŸ¥è½¯è¿æ¥æ˜¯å¦å­˜åœ¨
ls -la /usr/local/bin/iptv

# æµ‹è¯•å‘½ä»¤æ˜¯å¦å¯ç”¨
which iptv
iptv --help
```

## æ·»åŠ æ–°çš„ç›´æ’­æº

åœ¨ `config.json` çš„ `sources` éƒ¨åˆ†æ·»åŠ æ–°æºï¼š

```json
{
  "sources": {
    "existing_source": { ... },
    "new_source": {
      "name": "æ–°ç›´æ’­æº",
      "url": "https://example.com/playlist.m3u",
      "filename": "new_source.m3u",
      "enabled": true
    }
  }
}
```

## æ—¥å¿—å’Œç›‘æ§

### æ—¥å¿—æ–‡ä»¶
- **è¿è¡Œæ—¥å¿—**: `logs/iptv_manager_YYYYMMDD.log`
- **çŠ¶æ€æŠ¥å‘Š**: `logs/status_report_YYYYMMDD_HHMMSS.txt`
- **Cronæ—¥å¿—**: `logs/cron.log` (å¦‚æœé…ç½®äº†é‡å®šå‘)

### æ—¥å¿—çº§åˆ«
å¯åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®æ—¥å¿—çº§åˆ«ï¼š
- `DEBUG`: è¯¦ç»†è°ƒè¯•ä¿¡æ¯
- `INFO`: ä¸€èˆ¬ä¿¡æ¯ (é»˜è®¤)
- `WARNING`: è­¦å‘Šä¿¡æ¯
- `ERROR`: é”™è¯¯ä¿¡æ¯

## ğŸ§ª å®‰è£…æµ‹è¯•

å®‰è£…å®Œæˆåï¼Œå¯ä»¥è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸï¼š

```bash
# è¿›å…¥å®‰è£…ç›®å½•
cd /opt/IPTV-Manager

# è¿è¡Œæµ‹è¯•è„šæœ¬
python3 test_installation.py
```

æµ‹è¯•è„šæœ¬ä¼šæ£€æŸ¥ï¼š
- Pythonä¾èµ–åŒ…æ˜¯å¦æ­£ç¡®å®‰è£…
- é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰æ•ˆ
- è„šæœ¬æ˜¯å¦å¯ä»¥æ­£å¸¸æ‰§è¡Œ
- ç›®å½•ç»“æ„æ˜¯å¦æ­£ç¡®
- å¤šè¯­è¨€æ”¯æŒæ˜¯å¦å·¥ä½œ

### ç¨‹åºæ›´æ–°

IPTV Manageræ”¯æŒåœ¨çº¿æ›´æ–°åŠŸèƒ½ï¼š

#### é€šè¿‡äº¤äº’å¼èœå•æ›´æ–°
```bash
# å¯åŠ¨ç¨‹åº
iptv

# é€‰æ‹©èœå•é€‰é¡¹ 7 è¿›è¡Œæ›´æ–°
# ç¨‹åºä¼šè‡ªåŠ¨æ£€æŸ¥GitHubä¸Šçš„æœ€æ–°ç‰ˆæœ¬
# å¦‚æœ‰æ–°ç‰ˆæœ¬ä¼šæç¤ºæ˜¯å¦æ›´æ–°
```

#### æ‰‹åŠ¨æ›´æ–°
```bash
# é‡æ–°è¿è¡Œå®‰è£…è„šæœ¬å³å¯æ›´æ–°
curl -fsSL https://raw.githubusercontent.com/yuanweize/IPTV-Manager/refs/heads/main/install.sh | bash
```

æ›´æ–°åŠŸèƒ½ç‰¹ç‚¹ï¼š
- ğŸ”„ è‡ªåŠ¨æ£€æŸ¥æœ€æ–°ç‰ˆæœ¬
- ğŸ”§ ä¿æŒç°æœ‰é…ç½®å’Œæ•°æ®
- ğŸŒ æ”¯æŒåŒè¯­æ›´æ–°æç¤º
- ğŸ“¦ ä¸€é”®æ›´æ–°å®‰è£…

### ä½¿ç”¨Makefileï¼ˆå¯é€‰ï¼‰

é¡¹ç›®åŒ…å«Makefileæ¥ç®€åŒ–å¸¸ç”¨æ“ä½œï¼š

```bash
# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
make help

# è¿è¡Œå®‰è£…
make install

# è¿è¡Œæµ‹è¯•
make test

# ç›´æ¥ä¸‹è½½æº
make download

# æŸ¥çœ‹çŠ¶æ€
make status

# æ¸…ç†ä¸´æ—¶æ–‡ä»¶
make clean
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **pipå®‰è£…å¤±è´¥ (ModuleNotFoundError: No module named 'distutils.util')**
   ```bash
   # å®‰è£…ç¼ºå¤±çš„åŒ…
   sudo apt install -y python3-distutils python3-setuptools python3-dev
   
   # ä½¿ç”¨python -m pipå®‰è£…ä¾èµ–
   python3 -m pip install requests chardet --user
   ```

2. **æƒé™é”™è¯¯**
   ```bash
   sudo chown -R $USER:$USER /opt/IPTV-Manager
   chmod +x /opt/IPTV-Manager/iptv_manager.py
   ```

3. **ç½‘ç»œè¶…æ—¶**
   - å¢åŠ  `download.timeout` å€¼
   - æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œé˜²ç«å¢™è®¾ç½®

4. **ç¼–ç é—®é¢˜**
   - è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹ç¼–ç ï¼Œå¦‚æœ‰é—®é¢˜æ£€æŸ¥æºæ–‡ä»¶æ ¼å¼

5. **ç£ç›˜ç©ºé—´ä¸è¶³**
   - å¯ç”¨è‡ªåŠ¨æ¸…ç†: `"enable_cleanup": true`
   - å‡å°‘å¤‡ä»½ä¿ç•™å¤©æ•°

6. **Pythonç‰ˆæœ¬é—®é¢˜**
   ```bash
   # ç¡®ä¿ä½¿ç”¨Python 3.6+
   python3 --version
   
   # å¦‚æœç‰ˆæœ¬è¿‡ä½ï¼Œå‡çº§Python
   sudo apt install python3.9 python3.9-pip
   ```

### è°ƒè¯•æ¨¡å¼

```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
# åœ¨config.jsonä¸­è®¾ç½®: "level": "DEBUG"

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f /opt/IPTV-Manager/logs/iptv_manager_$(date +%Y%m%d).log
```

## æ€§èƒ½ä¼˜åŒ–

### å¹¶å‘è®¾ç½®
æ ¹æ®æœåŠ¡å™¨æ€§èƒ½è°ƒæ•´å¹¶å‘æ•°ï¼š
```json
{
  "download": {
    "max_workers": 4  // æ ¹æ®CPUæ ¸å¿ƒæ•°è°ƒæ•´
  }
}
```

### æ¸…ç†ç­–ç•¥
```json
{
  "maintenance": {
    "backup_retention_days": 7,   // å¤‡ä»½ä¿ç•™å¤©æ•°
    "log_retention_days": 30,     // æ—¥å¿—ä¿ç•™å¤©æ•°
    "enable_cleanup": true        // å¯ç”¨è‡ªåŠ¨æ¸…ç†
  }
}
```

## å®‰å…¨å»ºè®®

1. **æ–‡ä»¶æƒé™**: ç¡®ä¿è„šæœ¬å’Œé…ç½®æ–‡ä»¶æƒé™æ­£ç¡®è®¾ç½®
2. **ç½‘ç»œå®‰å…¨**: ä½¿ç”¨HTTPSæºï¼Œé¿å…ä¸å®‰å…¨çš„HTTPè¿æ¥
3. **å®šæœŸæ›´æ–°**: å®šæœŸæ›´æ–°Pythonä¾èµ–åº“
4. **æ—¥å¿—ç›‘æ§**: å®šæœŸæ£€æŸ¥æ—¥å¿—æ–‡ä»¶ï¼ŒåŠæ—¶å‘ç°å¼‚å¸¸

## ç‰ˆæœ¬ä¿¡æ¯

- **ç‰ˆæœ¬**: 2.0.8
- **é€‚ç”¨ç¯å¢ƒ**: Debian/UbuntuæœåŠ¡å™¨
- **Pythonè¦æ±‚**: 3.6+

## æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æ—¥å¿—æ–‡ä»¶ä¸­çš„é”™è¯¯ä¿¡æ¯
2. ç½‘ç»œè¿æ¥çŠ¶æ€
3. é…ç½®æ–‡ä»¶æ ¼å¼æ­£ç¡®æ€§
4. æ–‡ä»¶å’Œç›®å½•æƒé™è®¾ç½®

---

**æ³¨æ„**: è¯·ç¡®ä¿éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ï¼Œä»…ç”¨äºåˆæ³•çš„IPTVå†…å®¹è®¿é—®ã€‚